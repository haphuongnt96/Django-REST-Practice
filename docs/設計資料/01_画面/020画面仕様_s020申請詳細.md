# s202 申請詳細

## ヘッダ

※[020画面仕様_共通](020画面仕様_共通.md)参照

## 承認ルート欄（approval_routes）

### 項目一覧

|No.|項目名|項目種類|必須|初期値|表示形式|DBマッピング|備考|
|--:|---|---|---|---|---|---|---|
|1|承認状況|ラベル|-|-|-|T_申請.申請番号|-|
|2|申請者名|ラベル|-|-|-|M_社員.社員名|-|
|3|役職名|ラベル|-|-|-|M_役職.役職名|※現状はM_役職を使うが組織変更を考慮し役職名をT_承認ルート明細にもつ予定|
|4|承認状況|ラベル|-|-|-|M_承認ルート明細.承認ステータス|空白・承認・差戻|
|5|承認日|ラベル|-|-|MM/DD|M_承認ルート明細.承認日|-|

### 基本フロー

新規申請時、申請

### 代替フロー

対象テーブルを検索し画面に表示する。
1つの申請に承認ルートが複数存在する場合、行を分けて表示する。（承認ルートの件数分の行が表示される）

##### 表示順

* 承認ルート複数表示: T_承認ルート.承認ルートIDの降順（上が最新）
* 各役職の表示: T_承認ルート明細.順位 昇順
* 同一役職承認者表示: T_承認ルート明細.明細No 昇順

##### 対象テーブル

* T_申請
* T_承認ルート
* T_承認ルート明細
* M_社員
* M_役職

##### 条件

```
T_申請.申請ID = 【申請一覧】で選択した申請のID
```

※結合条件はER図を参照



## サブ機能欄（sub_functions）

### 項目一覧

|No.|項目名|項目種類|備考|
|--:|---|---|---|
|1|コメントボタン|ボタン|押下時s030コメントに遷移|
|2|コメント有表示|ラベル|未確認のコメントがある場合のみ表示|
|3|承認者ボタン|ボタン|押下時s021承認者追加をモーダル表示|
|4|通知者ボタン|ボタン|押下時s022通知者追加をモーダル表示|
|5|申請複写ボタン|ボタン|押下時申請内容をコピーして申請詳細を再表示|

### 仕様

#### コメント有表示

申請に該当するコメントで未確認ステータスのレコードがある場合、"有"を表示する。
それ以外の場合は非表示。

#### 申請複写

以下の対象項目を複写し新規申請として申請詳細画面を再表示する。<br>
※T_申請に保存せず、新規作成して入力した状態として表示する

##### 複写対象項目

* 申請情報欄
  * 申請内容（申請書名）
  * 申請部署
* 承認ルート
  * 最新の承認ルートを対象とする
  * 追加した承認者・通知者も複写される

## 申請情報欄（request_header）

### 項目一覧

|No.|項目名|項目種類|必須|初期値|最大桁|表示形式|DBマッピング|備考|
|--:|---|---|---|---|---|---|---|---|
|1|申請内容|ラベル|o|空白|?|-|M_申請.申請書名|-|
|2|申請書選択ボタン|ボタン|-|-|?|-|-|s011申請書選択をモーダル表示|
|3|申請部署|ドロップダウン|o|ログイン者所属部署(主)|?|-|?|申請後は入力不可|
|4|申請日時|ラベル|-|空白|?|YYYY/MM/DD hh24:mm|T_申請.申請日時|申請後のみ表示|
|5|申請者名|ラベル|-|-|?||M_社員.社員名|申請前はログイン者名、申請後はT_承認ルート.申請者社員コードから取得|

## 申請情報明細（request_detail）

### 項目一覧

|No.|項目名|項目種類|必須|初期値|最大桁|表示形式|DBマッピング|備考|
|--:|---|---|---|---|---|---|---|---|
|1|申請項目名|ラベル|-|-|?|-|M_申請明細.項目名|-|
|2|必須表示|ラベル|-|-|?|-|M_申請明細.必須|必須=trueの場合必須マークを表示|
|3|申請項目値|動的|-|空白|?|-|T_申請明細.申請項目値|M_申請明細|
|4|注釈|ラベル|-|-|?|-|T_申請明細.申請項目値|M_申請明細|
|5|添付ファイル|ファイルアップロード|-|-|?|-|||

## メイン機能欄（main_functions）

### 項目一覧

|No.|項目名|項目種類|備考|
|--:|---|---|---|
|1|申請ボタン|ボタン|申請ステータス = 空白・下書き・差戻しの場合活性|
|2|下書保存ボタン|ボタン|申請ステータス = 空白・下書きの場合活性|
|3|申請取消ボタン|ボタン|申請ステータス = 申請中の場合活性|
|4|削除ボタン|ボタン|申請ステータス = 下書き または 差戻しの場合活性|
|5|承認ボタン|ボタン|申請ステータス = 申請中 かつ 承認者の場合活性|
|6|否認ボタン|ボタン|申請ステータス = 申請中 かつ 承認者の場合活性|
|7|承認取消ボタン|ボタン|申請ステータス = 承認済 かつ 承認者の場合活性|
|8|印刷ボタン|ボタン|申請ステータス = 承認済の場合活性|

### 仕様

#### 申請

#### 下書保存
